{"version":3,"sources":["assets\\Scripts\\ECS\\ECSManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { TowerType } from \"../Enum\";\nimport ECSFactory from \"./ECSFactory\";\nimport EnemyEntity from \"./Entities/EnemyEntity\";\nimport TowerEntity from \"./Entities/TowerEntity\";\nimport NavSystem from \"./Systems/NavSystem\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class ECSManager extends cc.Component {\n    private static _instance:ECSManager=null\n    onLoad () {\n        if(null===ECSManager._instance){\n            ECSManager._instance=this\n        }\n        else{\n            this.destroy()\n            return\n        }\n    }\n\n    public static getInstance():ECSManager{\n        return ECSManager._instance\n    }\n\n    private towerEntityList:TowerEntity[]=[];\n    private enemyEntityList:EnemyEntity[]=[];\n\n    async createTowerEntity(tower_type:number,world_pos:cc.Vec2){\n        if(TowerType.Arrow==tower_type){\n            let entity:TowerEntity=await ECSFactory.getInstance().createArrowEntity(world_pos);\n\n            this.towerEntityList.push(entity);\n        }\n        else if(TowerType.Cannon==tower_type){\n            let entity:TowerEntity=await ECSFactory.getInstance().createCannonEntity(world_pos);\n\n            this.towerEntityList.push(entity);\n        }\n        else if(TowerType.Infantry==tower_type){\n            let entity:TowerEntity=await ECSFactory.getInstance().createInfantryEntity(world_pos);\n\n            this.towerEntityList.push(entity);\n        }\n        else if(TowerType.Warlock==tower_type){\n            let entity:TowerEntity=await ECSFactory.getInstance().createWarlockEntity(world_pos);\n\n            this.towerEntityList.push(entity);\n        }\n    }\n\n    async createEnemyEntity(enemy_type:number,road_data:any,actor_params:any){\n        let entity:EnemyEntity=await ECSFactory.getInstance().createEnemyEntity(enemy_type,road_data,actor_params);\n\n        this.enemyEntityList.push(entity);\n    }\n\n    navSystemEnemyUpdate(dt:number){\n        for(let i=0;i<this.enemyEntityList.length;++i){\n            NavSystem.getInstance().onUpdate(dt,this.enemyEntityList[i].navComponent,this.enemyEntityList[i].baseComponent,this.enemyEntityList[i].transformComponent);\n        }\n    }\n\n    update (dt) {\n        //敌军导航\n        this.navSystemEnemyUpdate(dt);\n    }\n}\n"]}