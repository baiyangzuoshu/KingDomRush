{"version":3,"sources":["assets\\Scripts\\ECS\\Systems\\AnimateSystem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { ResManagerPro } from \"../../../FrameWork/manager/ResManagerPro\";\nimport GameDataManager from \"../../Data/GameDataManager\";\nimport { AnimateState, RoleState, TowerType } from \"../../Enum\";\nimport FrameAnimate from \"../../Tools/FrameAnimate\";\nimport AnimateComponent from \"../Components/AnimateComponent\";\nimport AttackComponent from \"../Components/AttackComponent\";\nimport BaseComponent from \"../Components/BaseComponent\";\nimport RoleComponent from \"../Components/RoleComponent\";\nimport ECSManager from \"../ECSManager\";\nimport ECSUtil from \"../ECSUtil\";\nimport EnemyEntity from \"../Entities/EnemyEntity\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class AnimateSystem extends cc.Component {\n\n    private static _instance:AnimateSystem=null\n    onLoad () {\n        if(null===AnimateSystem._instance){\n            AnimateSystem._instance=this\n        }\n        else{\n            this.destroy()\n            return\n        }\n    }\n\n    public static getInstance():AnimateSystem{\n        return AnimateSystem._instance;\n    }\n    //\n    async onTowerUpdate(dt:number,towerRoleComponent:RoleComponent,towerAnimateComponent:AnimateComponent,towerBaseComponent:BaseComponent,towerAttackComponent:AttackComponent){\n        if(TowerType.Arrow==towerRoleComponent.type){\n            await this.onArrowUpdate(dt,towerAnimateComponent,towerBaseComponent,towerAttackComponent);\n        }\n        else if(TowerType.Warlock==towerRoleComponent.type){\n            await this.onWarlockUpdate(dt,towerAnimateComponent,towerBaseComponent,towerAttackComponent);\n        }\n        else if(TowerType.Cannon==towerRoleComponent.type){\n            await this.onCannonUpdate(dt,towerAnimateComponent,towerBaseComponent,towerAttackComponent);\n        }\n        else if(TowerType.Infantry==towerRoleComponent.type){\n            await this.onInfantryUpdate(dt,towerAnimateComponent,towerBaseComponent,towerAttackComponent);\n        }\n    }\n\n    async onInfantryUpdate(dt:number,infantryAnimateComponent:AnimateComponent,infantryBaseComponent:BaseComponent,infantryAttackComponent:AttackComponent){\n         // 播放放开门的动画\n         //this._play_open_door_anim();\n        infantryAnimateComponent.time-=dt;\n        if(infantryAnimateComponent.state==AnimateState.Start){\n            let anim=infantryBaseComponent.gameObject.getChildByName(\"anim\");\n            var frame_anim = anim.getComponent(FrameAnimate);\n            if(!frame_anim){\n                frame_anim=anim.addComponent(FrameAnimate);\n            }\n            let open_anim:cc.SpriteFrame[]=[];\n            for(let i=0;i<=3;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/bing_tower/bing1/bing1_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                open_anim.push(sf);\n            }\n            for(let i=0;i<=7;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/bing_tower/bing1/bing1_\"+3,cc.SpriteFrame) as cc.SpriteFrame;\n                open_anim.push(sf);\n            }\n            for(let i=3;i>0;i--){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/bing_tower/bing1/bing1_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                open_anim.push(sf);\n            }\n            frame_anim.sprite_frames = open_anim;\n            frame_anim.duration = 0.2;\n            frame_anim.play_once(function(){});\n    \n            infantryAnimateComponent.state=AnimateState.Playing;\n            infantryAnimateComponent.time=0.8;\n        }\n        else if(infantryAnimateComponent.state==AnimateState.Playing&&infantryAnimateComponent.time<=0){\n            // 放出多少个兵\n            //this._gen_actor(w_dst_pos);\n            infantryAttackComponent.enemyID = 6666;\n            infantryAnimateComponent.state=AnimateState.Stop;\n        }\n    }\n\n    async onCannonUpdate(dt:number,cannonAnimateComponent:AnimateComponent,cannonBaseComponent:BaseComponent,towerAttackComponent:AttackComponent){\n        let anim=cannonBaseComponent.gameObject.getChildByName(\"anim\");\n        let tower_level=1;\n        let bullet_level=1;\n\n        cannonAnimateComponent.time-=dt;\n        if(cannonAnimateComponent.state==AnimateState.Start){\n            var frame_anim = anim.getComponent(FrameAnimate);\n            if(!frame_anim){\n                frame_anim=anim.addComponent(FrameAnimate);\n            }\n            let shoot_anim:cc.SpriteFrame[]=[];\n            for(let i=0;i<=8;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/pao_tower/pao1/pao1_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                shoot_anim.push(sf);\n            }\n            frame_anim.sprite_frames = shoot_anim;\n            frame_anim.duration = 0.1;\n            //frame_anim.play_once(this.set_tower_idle.bind(this));\n            //this._play_preload_bullet_anim();\n            var start_pos_set = [cc.v2(-24, 2), cc.v2(-24, 3), cc.v2(-24, 2), cc.v2(-24, 2)];\n            var end_pos_set = [cc.v2(3, 20), cc.v2(3, 21), cc.v2(3, 24), cc.v2(3, 24)];\n            var delay_time_set = [0.8, 1.5, 1.2];\n            var rot_degree_set = [180 + Math.random() * 90, 180 + Math.random() * 90, 45];\n\n            let bullet_icon=cannonBaseComponent.gameObject.getChildByName(\"anim\").getChildByName(\"bullet_icon\")\n            let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/pao_tower/bullet/pao1_bullet\",cc.SpriteFrame) as cc.SpriteFrame;\n            bullet_icon.getComponent(cc.Sprite).spriteFrame = sf;\n            var delay = cc.delayTime(delay_time_set[tower_level - 1]);\n            var func = cc.callFunc(function() {\n                bullet_icon.scale = 1; // 子弹显示出来。\n                bullet_icon.x = start_pos_set[tower_level - 1].x;\n                bullet_icon.y = start_pos_set[tower_level - 1].y;\n                bullet_icon.angle = -45; // 开始的旋转角度\n                // 运行一个旋转\n                var rot = cc.rotateBy(0.4, rot_degree_set[tower_level - 1]);\n                bullet_icon.runAction(rot);\n                // end \n            }.bind(this), bullet_icon);\n            \n            var bz_array = [cc.v2(-10, 30), cc.v2(-10, 30), end_pos_set[tower_level - 1]];\n            var bz_action = cc.bezierTo(0.4, bz_array);\n            \n            var s = cc.scaleTo(0.1, 0);\n            var seq = cc.sequence([delay, func, bz_action, s]);\n            bullet_icon.runAction(seq);\n\n            cannonAnimateComponent.time=0.1;\n            cannonAnimateComponent.state=AnimateState.Playing\n        }\n        else if(cannonAnimateComponent.state==AnimateState.Playing&&cannonAnimateComponent.time<=0){\n            // 炮塔根据自己的等级来生成对应的子弹,配合炮塔动画来发射\n            var delay_set = [0.7, 0.8, 0.6, 1.3, 3.5];\n            var start_pos_set = [cc.v2(3, 16), cc.v2(3, 16), cc.v2(3, 16), cc.v2(-1, 20), cc.v2(-22, 24)];\n            // end \n            \n            var start_w_pos = anim.convertToWorldSpaceAR(start_pos_set[bullet_level - 1]);\n            var delay = cc.delayTime(delay_set[bullet_level - 1]);\n            var func = cc.callFunc(function(){\n                //cannon_bullet.shoot_at(bullet_level, start_w_pos, w_dst_pos);\n                \n            }.bind(this), cannonBaseComponent.gameObject);\n            \n            var seq = cc.sequence([delay, func]);\n            cannonBaseComponent.gameObject.runAction(seq);  \n\n            towerAttackComponent.enemyID = cannonAnimateComponent.id;\n            cannonAnimateComponent.state=AnimateState.Stop;\n        }\n    }\n\n    async onWarlockUpdate(dt:number,warlockAnimateComponent:AnimateComponent,warlockBaseComponent:BaseComponent,towerAttackComponent:AttackComponent){\n        //this._play_tower_anim();\n        //this._play_shoot_man_anim(w_dst_pos);\n        warlockAnimateComponent.time-=dt;\n        if(warlockAnimateComponent.state==AnimateState.Start){\n            let anim=warlockBaseComponent.gameObject.getChildByName(\"anim\");\n            var frame_anim = anim.getComponent(FrameAnimate);\n            if(!frame_anim){\n                frame_anim=anim.addComponent(FrameAnimate);\n            }\n            let tower_anim:cc.SpriteFrame[]=[];\n            for(let i=0;i<=4;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/fashi_tower/fashi1/fashi_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                tower_anim.push(sf);\n            }\n            frame_anim.sprite_frames = tower_anim;\n            frame_anim.duration =0.1;\n            frame_anim.play_once(function(){});\n\n            warlockAnimateComponent.time=0.1;\n            warlockAnimateComponent.state=AnimateState.Playing;\n        }\n        else if(warlockAnimateComponent.state==AnimateState.Playing&&warlockAnimateComponent.time<=0){\n            let man=warlockBaseComponent.gameObject.getChildByName(\"man\");\n            var frame_anim = man.getComponent(FrameAnimate);\n            if(!frame_anim){\n                frame_anim=man.addComponent(FrameAnimate);\n            }\n            var w_start_pos = man.convertToWorldSpaceAR(cc.v2(0, 0));\n            let w_dst_pos=warlockAnimateComponent.dstPos;\n            var b_up = w_start_pos.y < w_dst_pos.y;\n            \n            if (b_up) { // 上的动画\n                let shoot_up_anim:cc.SpriteFrame[]=[];\n                for(let i=0;i<=9;i++){\n                    let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/fashi_tower/shoot_man_1/up/up_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                    shoot_up_anim.push(sf);\n                }\n                frame_anim.sprite_frames = shoot_up_anim;\n                frame_anim.duration = 0.1;\n            }\n            else { // 下的动画\n                let shoot_down_anim:cc.SpriteFrame[]=[];\n                for(let i=0;i<=9;i++){\n                    let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/fashi_tower/shoot_man_1/down/down_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                    shoot_down_anim.push(sf);\n                }\n                frame_anim.sprite_frames = shoot_down_anim;\n                frame_anim.duration = 0.1;\n            }\n            frame_anim.play_once(function(){});\n            //end\n            towerAttackComponent.enemyID = warlockAnimateComponent.id;\n            warlockAnimateComponent.state=AnimateState.Stop;\n        }\n    }\n\n    async onArrowUpdate(dt:number,arrowAnimateComponent:AnimateComponent,arrowBaseComponent:BaseComponent,towerAttackComponent:AttackComponent){\n        let man=arrowBaseComponent.gameObject.getChildByName(\"rhs\");\n\n        var f_anim = man.getComponent(FrameAnimate);\n        if (!f_anim) {\n            f_anim = man.addComponent(FrameAnimate);\n        }\n        let w_dst_pos=arrowAnimateComponent.dstPos;\n        var w_pos = man.convertToWorldSpaceAR(cc.v2(0, 0));\n        var dir = w_dst_pos.sub(w_pos);\n        // 判断当前是要播放上，还是下\n        if (dir.y > 0) { // 上的动画\n            let up_anim:cc.SpriteFrame[]=[];\n            for(let i=1;i<=4;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/arrow_tower/arrow1/arrow_up_0\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                up_anim.push(sf);\n            }\n            f_anim.sprite_frames = up_anim;\n            f_anim.duration = 0.1;\n            f_anim.play_once(function(){\n                //this._set_anim_idle(man, 0);\n            }.bind(this));\n        }\n        else { // 下的动画\n            let down_anim:cc.SpriteFrame[]=[];\n            for(let i=1;i<=4;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/arrow_tower/arrow1/arrow_down_0\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                down_anim.push(sf);\n            }\n            f_anim.sprite_frames = down_anim;\n            f_anim.duration = 0.1;\n            f_anim.play_once(function(){\n                //this._set_anim_idle(man, 1);\n            }.bind(this));\n        }\n        //end \n        towerAttackComponent.enemyID = arrowAnimateComponent.id;\n        arrowAnimateComponent.state=AnimateState.Stop;\n    }\n    //\n    async onBulletUpdate(dt:number,bulletRoleComponent:RoleComponent,bulletAnimateComponent:AnimateComponent,\n        bulletAttackComponent:AttackComponent,bulletBaseComponent:BaseComponent){\n        if(TowerType.Arrow==bulletRoleComponent.type){\n            await this.onArrowBulletUpdate(dt,bulletRoleComponent,bulletAnimateComponent,bulletAttackComponent,bulletBaseComponent);\n        }\n        else if(TowerType.Warlock==bulletRoleComponent.type){\n            await this.onWarlockBulletUpdate(dt,bulletRoleComponent,bulletAnimateComponent,bulletAttackComponent,bulletBaseComponent);\n        }\n        else if(TowerType.Cannon==bulletRoleComponent.type){\n            await this.onCannonBulletUpdate(dt,bulletRoleComponent,bulletAnimateComponent,bulletAttackComponent,bulletBaseComponent);\n        }\n    }\n\n    async onCannonBulletUpdate(dt:number,bulletRoleComponent:RoleComponent,bulletAnimateComponent:AnimateComponent,\n        bulletAttackComponent:AttackComponent,bulletBaseComponent:BaseComponent){\n            let bullet_level = bulletRoleComponent.level;\n            let phy_params = GameDataManager.getInstance().cannon_bullet[bullet_level - 1];\n            let attack = GameDataManager.getInstance().arrow_bullet_params[bulletRoleComponent.level - 1].attack;\n\n            bulletAnimateComponent.time-=dt;\n            if(bulletAnimateComponent.state==AnimateState.Start){\n                let enemyEntity:EnemyEntity=ECSManager.getInstance().getEnemyEntityByID(bulletAttackComponent.enemyID);\n                let shoot_enemy = enemyEntity.baseComponent.gameObject;//enemy;\n                let anim=bulletBaseComponent.gameObject.getChildByName(\"anim\")\n                //this._set_bullet_idle();\n                let w_start_pos=bulletAnimateComponent.srcPos;\n                let w_dst_pos=bulletAnimateComponent.dstPos;\n                var start_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(cc.v2(w_start_pos.x,w_start_pos.y+29));\n                var dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(bulletAnimateComponent.dstPos);\n                // 发射的时候调整我们角度,设置好位置\n                bulletBaseComponent.gameObject.setPosition(start_pos);\n                anim.angle = 0;\n                // end  \n                \n                // 创建一个贝塞尔的action来控制我们的子弹的发射\n                // var dir = cc.pSub(w_dst_pos, w_start_pos);\n                var dir = w_dst_pos.sub(w_start_pos);\n                // var len = cc.pLength(dir);\n                var len = (dir.mag());\n                var time = len / phy_params.speed;\n                // end \n                var after_pos = cc.v2(0,0);//actor.position_after_time(time);\n                w_dst_pos = shoot_enemy.convertToWorldSpaceAR(after_pos);\n                dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(w_dst_pos);\n                // 求贝塞尔曲线的控制点，中点，然后拉高xxxxx\n                var ctrl_x;\n                var ctrl_y;\n                \n                {\n                    ctrl_x = (start_pos.x + dst_pos.x) * 0.5;\n                    ctrl_y = (dst_pos.y > start_pos.y) ? dst_pos.y : start_pos.y;\n                    ctrl_y += 40;\n                }\n                // end \n                \n                var ctrl_point_set = [cc.v2(ctrl_x, ctrl_y), cc.v2(ctrl_x, ctrl_y), dst_pos];\n                var bto_action = cc.bezierTo(time, ctrl_point_set);\n                let bomb_anim_frames:cc.SpriteFrame[]=[];\n                for(let i=1;i<=10;i++){\n                    let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/pao_tower/bom/bom\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                    bomb_anim_frames.push(sf);\n                }\n                // 播放爆炸动画，播放完后删除\n                var end_func = cc.callFunc(function(){\n                    \n                    //this.play_bullet_bomb_anim();\n                    anim.angle = 0;\n                    var frame_com = anim.getComponent(FrameAnimate);\n                    if(!frame_com){\n                        frame_com=anim.addComponent(FrameAnimate)\n                    }\n                    frame_com.sprite_frames = bomb_anim_frames;\n                    frame_com.duration = 0.1;\n                    \n                    // 爆炸结束后，删除子弹\n                    frame_com.play_once(function() {\n                        //this.node.removeFromParent();\n                        \n                    }.bind(this));\n                }.bind(this), bulletBaseComponent.gameObject);\n                var seq = cc.sequence([bto_action, end_func]);\n                bulletBaseComponent.gameObject.runAction(seq);\n                \n                // 逻辑与图像分离\n                var degree;\n                if (w_dst_pos.x < w_start_pos.x) { // 在左边\n                    degree = -180 + Math.random() * 10;\n                }\n                else {\n                    degree = 180 - Math.random() * 10;\n                }\n                var rot = cc.rotateBy(time, degree);\n                anim.runAction(rot);\n\n                bulletAnimateComponent.state=AnimateState.Playing;\n                bulletAnimateComponent.time=0.8;\n            }\n            else if(bulletAnimateComponent.state==AnimateState.Playing&&bulletAnimateComponent.time<=0){\n                var bomb_R = phy_params.bomb_R;\n                var w_dst_pos = bulletBaseComponent.gameObject.convertToWorldSpaceAR(cc.v2(0,0));\n                ECSUtil.getInstance().on_bullet_bomb(w_dst_pos,bomb_R,attack);\n\n                bulletRoleComponent.state=RoleState.Dead\n                bulletAttackComponent.enemyID=0;\n                bulletAnimateComponent.state=AnimateState.Stop;\n            }\n    }\n\n    async onWarlockBulletUpdate(dt:number,bulletRoleComponent:RoleComponent,bulletAnimateComponent:AnimateComponent,\n        bulletAttackComponent:AttackComponent,bulletBaseComponent:BaseComponent){\n\n        let enemyEntity:EnemyEntity=ECSManager.getInstance().getEnemyEntityByID(bulletAttackComponent.enemyID);\n        let attack = GameDataManager.getInstance().arrow_bullet_params[bulletRoleComponent.level - 1].attack;\n\n        bulletAnimateComponent.time-=dt;\n\n        if(bulletAnimateComponent.state==AnimateState.Start){\n            let bullet_level = bulletRoleComponent.level;\n            let speed = GameDataManager.getInstance().warlock_bullet_params[bullet_level - 1].speed;\n            let shoot_enemy = enemyEntity.baseComponent.gameObject;\n            let w_start_pos=bulletAnimateComponent.srcPos;\n            let w_dst_pos=bulletAnimateComponent.dstPos;\n            let anim=bulletBaseComponent.gameObject.getChildByName(\"anim\")\n            //this._set_bullet_idle();\n            var start_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(cc.v2(w_start_pos.x,w_start_pos.y+30));\n            var dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(w_dst_pos);\n            bulletBaseComponent.gameObject.setPosition(start_pos);\n            \n            // var dir = cc.pSub(w_dst_pos, w_start_pos);\n            var dir = w_dst_pos.sub(w_start_pos);\n            // var len = cc.pLength(dir);\n            var len = (dir.mag());\n            var time = len / speed;\n            \n            var after_pos = cc.v2(0,-30);//actor.position_after_time(time);\n            w_dst_pos = shoot_enemy.convertToWorldSpaceAR(after_pos);\n            dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(w_dst_pos);\n    \n            var m = cc.moveBy(time, w_dst_pos.x - w_start_pos.x, w_dst_pos.y - w_start_pos.y);\n            let bomb_anim:cc.SpriteFrame[]=[];\n            for(let i=0;i<=8;i++){\n                let sf=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/fashi_tower/bomb/bomb_\"+i,cc.SpriteFrame) as cc.SpriteFrame;\n                bomb_anim.push(sf);\n            }\n            var func = cc.callFunc(function(){\n                var frame_anim = anim.getComponent(FrameAnimate);\n                if(!frame_anim){\n                    frame_anim=anim.addComponent(FrameAnimate)\n                }\n                frame_anim.sprite_frames = bomb_anim;\n                frame_anim.duration = 0.1;\n                frame_anim.play_once(function(){\n                    //this.on_bullet_bomb(w_dst_pos);\n                    //this.node.removeFromParent();\n                }.bind(this));\n                // 播放爆炸动画\n            }.bind(this),anim);\n\n            var end_func = cc.callFunc(function(){\n                \n            }.bind(this), bulletBaseComponent.gameObject);\n\n            var seq = cc.sequence([m, func,cc.delayTime(0.1),end_func]);\n            bulletBaseComponent.gameObject.runAction(seq);\n\n            bulletAnimateComponent.state=AnimateState.Playing;\n            bulletAnimateComponent.time=0.8;\n        }\n        else if(bulletAnimateComponent.state==AnimateState.Playing&&bulletAnimateComponent.time<=0){\n            bulletAnimateComponent.state=AnimateState.Stop;\n            bulletRoleComponent.state=RoleState.Dead\n            bulletAttackComponent.enemyID=0;\n\n            if(enemyEntity){\n                ECSUtil.getInstance().on_arrowBullet_shoot(attack,enemyEntity.unitComponent,enemyEntity.baseComponent,enemyEntity.roleComponent);\n            }\n        }\n    }\n\n    async onArrowBulletUpdate(dt:number,bulletRoleComponent:RoleComponent,bulletAnimateComponent:AnimateComponent,\n        bulletAttackComponent:AttackComponent,bulletBaseComponent:BaseComponent){\n\n        let enemyEntity:EnemyEntity=ECSManager.getInstance().getEnemyEntityByID(bulletAttackComponent.enemyID);\n        let attack = GameDataManager.getInstance().arrow_bullet_params[bulletRoleComponent.level - 1].attack;\n        bulletAnimateComponent.time-=dt;\n\n        if(bulletAnimateComponent.state==AnimateState.Start){\n            let speed = GameDataManager.getInstance().arrow_bullet_params[bulletRoleComponent.level - 1].speed;\n            \n            let shoot_enemy = enemyEntity.baseComponent.gameObject;//enemy;\n            let anim=bulletBaseComponent.gameObject.getChildByName(\"anim\")\n            var start_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(cc.v2(bulletAnimateComponent.srcPos.x,bulletAnimateComponent.srcPos.y+30));\n            var dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(bulletAnimateComponent.dstPos);\n            \n            // 发射的时候调整我们角度,设置好位置\n            bulletBaseComponent.gameObject.setPosition(start_pos);\n            anim.angle = 270;\n            // end  \n            // 创建一个贝塞尔的action来控制我们的子弹的发射\n            // var dir = cc.pSub(w_dst_pos, w_start_pos);\n            var dir = bulletAnimateComponent.dstPos.sub(bulletAnimateComponent.srcPos);\n\n            // var len = cc.pLength(dir);\n            var len = (dir.mag());\n            var time = len / speed;\n\n            var after_pos = cc.v2(0,-29);//actor.position_after_time(time);\n            let w_dst_pos = shoot_enemy.convertToWorldSpaceAR(after_pos);\n            dst_pos = bulletBaseComponent.gameObject.parent.convertToNodeSpaceAR(w_dst_pos);\n            // end \n            // 求贝塞尔曲线的控制点，中点，然后拉高xxxxx\n            var ctrl_x;\n            var ctrl_y;\n            \n            // if (Math.abs(dir.x) <= 10 && dir.y < 0) {\n            if (0) {\n                ctrl_y = (start_pos.y + dst_pos.y) * 0.5;\n                if (start_pos.x > dst_pos.x) {\n                    ctrl_x = dst_pos.x;\n                    // ctrl_x -= 20;\n                }\n                else {\n                    ctrl_x = dst_pos.x;\n                    // ctrl_x += 20;\n                }\n            }\n            else {\n                ctrl_x = (start_pos.x + dst_pos.x) * 0.5;\n                ctrl_y = (dst_pos.y > start_pos.y) ? dst_pos.y : start_pos.y;\n                ctrl_y += 40;\n            }\n            // end \n            var ctrl_point_set = [cc.v2(ctrl_x, ctrl_y), cc.v2(ctrl_x, ctrl_y), dst_pos];\n            var bto_action = cc.bezierTo(time, ctrl_point_set);\n            // this.node.runAction(bto_action); // 发射到目标点;\n            // 换图，把这个完整的键，换成我们的半截键\n            let decal_arrow_sprite_frame:cc.SpriteFrame=await ResManagerPro.Instance.IE_GetAsset(\"textures\",\"game_scene/tower/arrow_tower/bullet/decal_arrow\",cc.SpriteFrame) as cc.SpriteFrame;\n            var func = cc.callFunc(function(){\n                var s = anim.getComponent(cc.Sprite);\n                s.spriteFrame = decal_arrow_sprite_frame;\n                \n            }.bind(this), bulletBaseComponent.gameObject);\n            \n            var end_func = cc.callFunc(function(){\n                \n                //bulletBaseComponent.gameObject.removeFromParent();\n            }.bind(this), bulletBaseComponent.gameObject);\n            var seq = cc.sequence([bto_action, func, cc.delayTime(1), cc.fadeOut(0.3), end_func]);\n            bulletBaseComponent.gameObject.runAction(seq);\n            // 逻辑与图像分离\n            var degree;\n            if (bulletAnimateComponent.dstPos.x < bulletAnimateComponent.srcPos.x) { // 在左边\n                degree = -180 + Math.random() * 10;\n            }\n            else {\n                degree = 180 - Math.random() * 10;\n            }\n            var rot = cc.rotateBy(time, degree);\n            anim.runAction(rot);\n\n            bulletAnimateComponent.state=AnimateState.Playing;\n            bulletAnimateComponent.time=0.8;\n        }\n        else if(bulletAnimateComponent.state==AnimateState.Playing&&bulletAnimateComponent.time<=0){\n            bulletAnimateComponent.state=AnimateState.Stop;\n            bulletRoleComponent.state=RoleState.Dead\n            bulletAttackComponent.enemyID=0;\n            if(enemyEntity){\n                ECSUtil.getInstance().on_arrowBullet_shoot(attack,enemyEntity.unitComponent,enemyEntity.baseComponent,enemyEntity.roleComponent);\n            }\n        }\n        \n    }\n}\n"]}