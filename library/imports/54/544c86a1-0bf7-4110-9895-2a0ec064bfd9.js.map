{"version":3,"sources":["assets\\Scripts\\ECS\\Systems\\AttackSystem.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,4EAA4E;AAC5E,mBAAmB;AACnB,sFAAsF;AACtF,8BAA8B;AAC9B,sFAAsF;;;;;;;;;;;;;;;;;;;;;AAOtF,4CAAuC;AAGjC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA0C,gCAAY;IAAtD;;IA6BA,CAAC;qBA7BoB,YAAY;IAE7B,6BAAM,GAAN;QACI,IAAG,IAAI,KAAG,cAAY,CAAC,SAAS,EAAC;YAC7B,cAAY,CAAC,SAAS,GAAC,IAAI,CAAA;SAC9B;aACG;YACA,IAAI,CAAC,OAAO,EAAE,CAAA;YACd,OAAM;SACT;IACL,CAAC;IAEa,wBAAW,GAAzB;QACI,OAAO,cAAY,CAAC,SAAS,CAAC;IAClC,CAAC;IAED,+BAAQ,GAAR,UAAS,EAAS,EAAC,oBAAoC,EAAC,kBAAgC,EACpF,kBAAgC;QAChC,IAAI,WAAW,GAAa,oBAAU,CAAC,WAAW,EAAE,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;QACtG,IAAG,IAAI,IAAE,WAAW,EAAC;YACjB,OAAM;SACT;QAED,IAAI,UAAU,GAAG,kBAAkB,CAAC,UAAU,CAAC,qBAAqB,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAClF,IAAI,SAAS,GAAC,WAAW,CAAC,aAAa,CAAC,UAAU,CAAC,qBAAqB,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAEtF,oBAAU,CAAC,WAAW,EAAE,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,IAAI,EAAC,kBAAkB,CAAC,KAAK,EAAC,UAAU,EAAC,SAAS,EAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;QAChJ,oBAAoB,CAAC,OAAO,GAAC,CAAC,CAAC;IACnC,CAAC;;IA3Bc,sBAAS,GAAc,IAAI,CAAA;IADzB,YAAY;QADhC,OAAO;OACa,YAAY,CA6BhC;IAAD,mBAAC;CA7BD,AA6BC,CA7ByC,EAAE,CAAC,SAAS,GA6BrD;kBA7BoB,YAAY","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameDataManager from \"../../Data/GameDataManager\";\nimport AttackComponent from \"../Components/AttackComponent\";\nimport BaseComponent from \"../Components/BaseComponent\";\nimport RoleComponent from \"../Components/RoleComponent\";\nimport TransformComponent from \"../Components/TransformComponent\";\nimport ECSManager from \"../ECSManager\";\nimport EnemyEntity from \"../Entities/EnemyEntity\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class AttackSystem extends cc.Component {\n    private static _instance:AttackSystem=null\n    onLoad () {\n        if(null===AttackSystem._instance){\n            AttackSystem._instance=this\n        }\n        else{\n            this.destroy()\n            return\n        }\n    }\n\n    public static getInstance():AttackSystem{\n        return AttackSystem._instance;\n    }\n\n    onUpdate(dt:number,towerAttackComponent:AttackComponent,towerBaseComponent:BaseComponent,\n        towerRoleComponent:RoleComponent){\n        let enemyEntity:EnemyEntity=ECSManager.getInstance().getEnemyEntityByID(towerAttackComponent.enemyID);\n        if(null==enemyEntity){\n            return\n        }\n        \n        var center_pos = towerBaseComponent.gameObject.convertToWorldSpaceAR(cc.v2(0, 0));\n        var enemy_pos=enemyEntity.baseComponent.gameObject.convertToWorldSpaceAR(cc.v2(0, 0));\n        \n        ECSManager.getInstance().createBulletEntity(towerRoleComponent.type,towerRoleComponent.level,center_pos,enemy_pos,towerAttackComponent.enemyID);\n        towerAttackComponent.enemyID=0;\n    } \n}\n"]}